{"version":3,"file":"0-ededd4bf.js","sources":["../../../.svelte-kit/adapter-node/entries/pages/_layout.server.ts.js","../../../.svelte-kit/adapter-node/nodes/0.js"],"sourcesContent":["import { r as redirect } from \"../../chunks/index.js\";\nimport { c as collections } from \"../../chunks/database.js\";\nimport { v as validateModel, m as models, o as oldModels } from \"../../chunks/models.js\";\nimport { a as authCondition, r as requiresUser } from \"../../chunks/auth.js\";\nimport { D as DEFAULT_SETTINGS } from \"../../chunks/Settings.js\";\nvar UrlDependency = /* @__PURE__ */ ((UrlDependency2) => {\n  UrlDependency2[\"ConversationList\"] = \"conversation:list\";\n  UrlDependency2[\"Conversation\"] = \"conversation\";\n  return UrlDependency2;\n})(UrlDependency || {});\nconst load = async ({ locals, depends, url }) => {\n  const urlModel = url.searchParams.get(\"model\");\n  depends(UrlDependency.ConversationList);\n  if (urlModel) {\n    const isValidModel = validateModel(models).safeParse(urlModel).success;\n    if (isValidModel) {\n      await collections.settings.updateOne(\n        authCondition(locals),\n        { $set: { activeModel: urlModel } },\n        { upsert: true }\n      );\n    }\n    throw redirect(302, url.pathname);\n  }\n  return {\n    conversations: [],\n    settings: {\n      shareConversationsWithModelAuthors: DEFAULT_SETTINGS.shareConversationsWithModelAuthors,\n      ethicsModalAcceptedAt: null,\n      activeModel: DEFAULT_SETTINGS.activeModel,\n      searchEnabled: false,\n      customPrompts: {}\n    },\n    models: models.map((model) => ({\n      id: model.id,\n      name: model.name,\n      websiteUrl: model.websiteUrl,\n      modelUrl: model.modelUrl,\n      is_local: model.is_local,\n      datasetName: model.datasetName,\n      datasetUrl: model.datasetUrl,\n      displayName: model.displayName,\n      description: model.description,\n      promptExamples: model.promptExamples,\n      parameters: model.parameters,\n      preprompt: model.preprompt\n    })),\n    oldModels,\n    user: locals.user && {\n      username: locals.user.username,\n      avatarUrl: locals.user.avatarUrl,\n      email: locals.user.email\n    },\n    requiresLogin: requiresUser,\n    messagesBeforeLogin: 0\n  };\n};\nexport {\n  load\n};\n","import * as server from '../entries/pages/_layout.server.ts.js';\n\nexport const index = 0;\nlet component_cache;\nexport const component = async () => component_cache ??= (await import('../entries/pages/_layout.svelte.js')).default;\nexport { server };\nexport const server_id = \"src/routes/+layout.server.ts\";\nexport const imports = [\"_app/immutable/nodes/0.3dbc19b7.js\",\"_app/immutable/chunks/index.98ebe618.js\",\"_app/immutable/chunks/public.865a5e26.js\",\"_app/immutable/chunks/singletons.db0d2646.js\",\"_app/immutable/chunks/parse.bee59afc.js\",\"_app/immutable/chunks/stores.997706bb.js\",\"_app/immutable/chunks/LoadingModalWritable.b3f40ccb.js\",\"_app/immutable/chunks/share.4f3afad4.js\",\"_app/immutable/chunks/LocalDB.a5da0a64.js\"];\nexport const stylesheets = [\"_app/immutable/assets/0.fb679674.css\"];\nexport const fonts = [];\n"],"names":[],"mappings":"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"}