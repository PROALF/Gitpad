import{S as y,i as E,s as R,a as b,o as q,p as I,f as p,g as P,q as L,j as T,r as $,u as j,v as O,w as k,m as c,x as g}from"../chunks/index.98ebe618.js";import{a as h,e as _,E as B,g as w}from"../chunks/public.865a5e26.js";import{b as u}from"../chunks/singletons.db0d2646.js";import{p as D}from"../chunks/stores.997706bb.js";import{C as G,f as M,p as f}from"../chunks/pendingMessage.76d0664e.js";import{p as S}from"../chunks/pendingMessageIdToRetry.700325ba.js";import{s as J}from"../chunks/share.4f3afad4.js";function N(o){let l,r,t,i;return document.title=l=o[0].title,t=new G({props:{loading:o[1],shared:!0,messages:o[0].messages,searches:o[0].searches,models:o[0].models,currentModel:M(o[0].models,o[0].model),settings:o[0].settings,loginRequired:!o[2].error&&(o[0].requiresLogin?!o[0].user:!o[0].settings.ethicsModalAcceptedAt&&!!h)}}),t.$on("message",o[7]),t.$on("share",o[6]),t.$on("retry",o[8]),{c(){r=b(),q(t.$$.fragment)},l(e){I("svelte-8oibt4",document.head).forEach(p),r=P(e),L(t.$$.fragment,e)},m(e,n){T(e,r,n),$(t,e,n),i=!0},p(e,[n]){(!i||n&1)&&l!==(l=e[0].title)&&(document.title=l);const a={};n&2&&(a.loading=e[1]),n&1&&(a.messages=e[0].messages),n&1&&(a.searches=e[0].searches),n&1&&(a.models=e[0].models),n&1&&(a.currentModel=M(e[0].models,e[0].model)),n&1&&(a.settings=e[0].settings),n&5&&(a.loginRequired=!e[2].error&&(e[0].requiresLogin?!e[0].user:!e[0].settings.ethicsModalAcceptedAt&&!!h)),t.$set(a)},i(e){i||(j(t.$$.fragment,e),i=!0)},o(e){O(t.$$.fragment,e),i=!1},d(e){e&&p(r),k(t,e)}}}function U(o,l,r){let t,i,e;c(o,D,s=>r(2,t=s)),c(o,f,s=>r(3,i=s)),c(o,S,s=>r(4,e=s));let{data:n}=l,a=!1;async function d(){console.log("create");try{r(1,a=!0);const s=await fetch(`${u}/conversation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fromShare:t.params.id,model:n.model})});if(!s.ok){_.set("Error while creating conversation, try again."),console.error("Error while creating conversation: "+await s.text());return}const{conversationId:m}=await s.json();return m}catch(s){throw _.set(B.default),console.error(String(s)),s}}async function A(){const s=`${window.location.origin}${window.location.pathname}`;J(s,n.title)}const C=s=>d().then(m=>(g(f,i=s.detail,i),w(`${u}/conversation/${m}`,{invalidateAll:!0}))).finally(()=>r(1,a=!1)),v=s=>d().then(m=>(g(S,e=s.detail.id,e),g(f,i=s.detail.content,i),w(`${u}/conversation/${m}`,{invalidateAll:!0}))).finally(()=>r(1,a=!1));return o.$$set=s=>{"data"in s&&r(0,n=s.data)},[n,a,t,i,e,d,A,C,v]}class X extends y{constructor(l){super(),E(this,l,U,N,R,{data:0})}}export{X as component};
